{% extends 'base.html' %}

{% block head %}
<title>Historique</title>
{% endblock %}

{% block body %}
<div class="content">


    <div class="description">
        <h4>Résultats en france en Euros, pour les zones commerciales, pour toutes les familles de produits, pour toutes les enseignes, pour le mois de {{mois_string}} {{annee}}</h4>
    </div>


    <div class="filtre">
        <form action="/historique" method="POST">
            
            <select style="width:150px;height:30px" name="mois" id="mois-select">
                <option value="2|fevrier">--Choix du mois--</option>
                <option value="2|fevrier">février</option>
                <option value="3|mars">mars</option>
                <option value="4|avril">avril</option>
                <option value="5|mai">mai</option>
                <option value="6|juin">juin</option>
                <option value="6|juin">juin</option>
                <option value="7|juillet">juillet</option>
                <option value="8|aout">aout</option>
                <option value="9|septembre">septembre</option>
                <option value="10|octobre">octobre</option>
                <option value="11|novembre">novembre</option>
                <option value="12|decembre">decembre</option>
            </select></br>
    
            <button class="button" type="submit">Rechercher</button>
        </form>
    </div>


    <div class="historique">

        <table>
            <tr>
                <th></th>
                <th colspan="4" bgcolor="#0FA"> {{annee}} </th>
                <th colspan="4" bgcolor="#0FA"> {{annee-1}} </th>
                <th colspan="2" rowspan="2" bgcolor="#0FA"> Ecart entre {{mois_string}} {{annee-1}} et {{mois_string}} {{annee}} </th>
                <th colspan="2" rowspan="2" bgcolor="#0FA"> Ecart du cumul entre {{mois_string}} {{annee-1}} et {{mois_string}} {{annee}} </th>
            </tr>
                
            <tr>
                <th></th> 
                <th colspan="2" bgcolor="#0FA"> {{mois_string}} </th> <th colspan="2" bgcolor="#0FA"> Cumul de janvier à {{mois_string}} </th> 
                <th colspan="2" bgcolor="#0FA"> {{mois_string}} </th> <th colspan="2" bgcolor="#0FA"> Cumul de janvier à {{mois_string}} </th> 
            </tr>
            <tr cellpadding="15">
                <th bgcolor="#0FA">CA</th> 
                <th bgcolor="#0FA">Budget</th> <th bgcolor="#0FA">Reel</th> 
                <th bgcolor="#0FA">Budget</th> <th bgcolor="#0FA">Reel</th> 
                <th bgcolor="#0FA">Budget</th> <th bgcolor="#0FA">Reel</th> 
                <th bgcolor="#0FA">Budget</th> <th bgcolor="#0FA">Reel</th>
                <th bgcolor="#0FA">Budget</th> <th bgcolor="#0FA">Reel</th> 
                <th bgcolor="#0FA">Budget</th> <th bgcolor="#0FA">Reel</th>
            </tr>
            <tr>
                <th bgcolor="#0FA">Hi-fi</th>
                <td>{{ hifi_obj_cur|round|int }}</td>
                <td>{{ hifi_reel_cur|round|int }}</td>
                <td>{{ hifi_obj_cumul_cur|round|int }}</td>
                <td>{{ hifi_reel_cumul_cur|round|int }}</td>

                <td>{{ hifi_obj_prev|round|int }}</td>
                <td>{{ hifi_reel_prev|round|int }}</td>
                <td>{{ hifi_obj_cumul_prev|round|int }}</td>
                <td>{{ hifi_reel_cumul_prev|round|int }}</td>

                <td> {{ '{0:0.2f}'.format((hifi_obj_cur - hifi_obj_prev) / hifi_obj_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((hifi_reel_cur - hifi_reel_prev) / hifi_obj_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((hifi_obj_cumul_cur - hifi_obj_cumul_prev) / hifi_obj_cumul_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((hifi_reel_cumul_cur - hifi_reel_cumul_prev) / hifi_obj_cumul_cur * 100) }} %</td>
            </tr>
            <tr>
                <th bgcolor="#0FA">Magnéto</th>
                <td>{{ magneto_obj_cur|round|int }}</td>
                <td>{{ magneto_reel_cur|round|int }}</td>
                <td>{{ magneto_obj_cumul_cur|round|int }}</td>
                <td>{{ magneto_reel_cumul_cur|round|int }}</td>

                <td>{{ magneto_obj_prev|round|int }}</td>
                <td>{{ magneto_reel_prev|round|int }}</td>
                <td>{{ magneto_obj_cumul_prev|round|int }}</td>
                <td>{{ magneto_reel_cumul_prev|round|int }}</td>

                <td> {{ '{0:0.2f}'.format((magneto_obj_cur - magneto_obj_prev) / magneto_obj_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((magneto_reel_cur - magneto_reel_prev) / magneto_obj_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((magneto_obj_cumul_cur - magneto_obj_cumul_prev) / magneto_obj_cumul_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((magneto_reel_cumul_cur - magneto_reel_cumul_prev) / magneto_obj_cumul_cur * 100) }} %</td>
            </tr>
            <tr>
                <th bgcolor="#0FA">Fours</th>
                <td>{{ fours_obj_cur|round|int }}</td>
                <td>{{ fours_reel_cur|round|int }}</td>
                <td>{{ fours_obj_cumul_cur|round|int }}</td>
                <td>{{ fours_reel_cumul_cur|round|int }}</td>

                <td>{{ fours_obj_prev|round|int }}</td>
                <td>{{ fours_reel_prev|round|int }}</td>
                <td>{{ fours_obj_cumul_prev|round|int }}</td>
                <td>{{ fours_reel_cumul_prev|round|int }}</td>

                <td> {{ '{0:0.2f}'.format((fours_obj_cur - fours_obj_prev) / fours_obj_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((fours_reel_cur - fours_reel_prev) / fours_obj_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((fours_obj_cumul_cur - fours_obj_cumul_prev) / fours_obj_cumul_cur * 100) }} %</td>
                <td> {{ '{0:0.2f}'.format((fours_reel_cumul_cur - fours_reel_cumul_prev) / fours_obj_cumul_cur * 100) }} %</td>
            </tr>
            <tr>
                <th bgcolor="#0FA">Total</th>
                <td>{{ (hifi_obj_cur+magneto_obj_cur+fours_obj_cur)|round|int }}</td>
                <td>{{ (hifi_reel_cur+magneto_reel_cur+fours_reel_cur)|round|int }}</td>
                <td>{{ (hifi_obj_cumul_cur+magneto_obj_cumul_cur+fours_obj_cumul_cur)|round|int }}</td>
                <td>{{ (hifi_reel_cumul_cur+magneto_reel_cumul_cur+fours_reel_cumul_cur)|round|int }}</td>

                <td>{{ (hifi_obj_prev+magneto_obj_prev+fours_obj_prev)|round|int }}</td>
                <td>{{ (hifi_reel_prev+magneto_reel_prev+fours_reel_prev)|round|int }}</td>
                <td>{{ (hifi_obj_cumul_prev+magneto_obj_cumul_prev+fours_obj_cumul_prev)|round|int }}</td>
                <td>{{ (hifi_reel_cumul_prev+magneto_reel_cumul_prev+fours_reel_cumul_prev)|round|int }}</td>
            </tr>
        </table>

        <br>
        <form action="/export/historique" method="POST">
            
            <label for="fname">Output file </label>
            <input type="text" id="fname" name="output_file" value="/Users/alexei/Downloads/converted_file.xlsx"><br><br>
            
            <input type="submit" value="Export" />
        </form>

    </div>
    

</div>
{% endblock %}


