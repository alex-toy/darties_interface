{% extends 'base.html' %}

{% block head %}
<title>détails</title>
{% endblock %}

{% block body %}
<div class="content">


    <div class="description">
        <h3 style="text-align: center">Détails en France en Euros, de tous les indicateurs pour le mois de {{mois}} {{current_year}} </h3>
    </div>

    <div class="filtre">
        <form action="/details" method="POST">
        
            <label for="mois-select">Année</label>
            <select name="annee" id="mois-select">
                <option value="2020">--Choix de l'année--</option>
                <option value="2020">2020</option>
                <option value="2021">2021</option>
            </select></br>
            
            <label for="mois-select">Mois</label>
            <select name="mois" id="mois-select">
                <option value="1|janvier">--Choix du mois--</option>
                <option value="1|janvier">janvier</option>
                <option value="2|février">février</option>
                <option value="3|mars">mars</option>
                <option value="4|avril">avril</option>
                <option value="5|mai">mai</option>
                <option value="6|juin">juin</option>
                <option value="7|juillet">juillet</option>
                <option value="8|aout">aout</option>
                <option value="9|septembre">septembre</option>
                <option value="10|octobre">octobre</option>
                <option value="11|novembre">novembre</option>
                <option value="12|decembre">decembre</option>
            </select></br>
    
            <input type="submit" value="Envoyer" />
        </form>
    </div>


    <div class="details">
            
    <table>
        <tr>
            <th></th>
            <th colspan="3" bgcolor="#0FA"> CA </th>
            <th colspan="3" bgcolor="#0FA"> Ventes </th>
            <th colspan="3" bgcolor="#0FA"> Marge </th>
        </tr>

        <tr>
            <th></th>
            <th bgcolor="#0FA">Budget</th><th bgcolor="#0FA">Reel</th bgcolor="#0FA"><th bgcolor="#0FA">Ecart</th>
            <th bgcolor="#0FA">Budget</th><th bgcolor="#0FA">Reel</th bgcolor="#0FA"><th bgcolor="#0FA">Ecart</th>
            <th bgcolor="#0FA">Budget</th><th bgcolor="#0FA">Reel</th bgcolor="#0FA"><th bgcolor="#0FA">Ecart</th>
        </tr>
            
            <tr>
                <th bgcolor="#0FA">Hi-fi</th>

                <td> {{ '{0:0.2f}'.format(hifi_kpi["ca_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(hifi_kpi["ca_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(hifi_kpi["ca_reel"]-hifi_kpi["ca_objectif"]) }}</td>

                <td> {{ '{0:0.2f}'.format(hifi_kpi["ventes_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(hifi_kpi["vente_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(hifi_kpi["vente_reel"]-hifi_kpi["ventes_objectif"]) }}</td>

                <td> {{ '{0:0.2f}'.format(hifi_kpi["marge_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(hifi_kpi["marge_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(hifi_kpi["marge_reel"]-hifi_kpi["marge_objectif"]) }}</td>
            </tr>

            <tr>
                <th bgcolor="#0FA">Fours</th>

                <td> {{ '{0:0.2f}'.format(fours_kpi["ca_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(fours_kpi["ca_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(fours_kpi["ca_reel"]-fours_kpi["ca_objectif"]) }}</td>

                <td> {{ '{0:0.2f}'.format(fours_kpi["ventes_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(fours_kpi["vente_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(fours_kpi["vente_reel"]-fours_kpi["ventes_objectif"]) }}</td>

                <td> {{ '{0:0.2f}'.format(fours_kpi["marge_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(fours_kpi["marge_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(fours_kpi["marge_reel"]-fours_kpi["marge_objectif"]) }}</td>

            </tr>

            <tr>
                <th bgcolor="#0FA">Magnétoscopes</th>

                <td> {{ '{0:0.2f}'.format(magneto_kpi["ca_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(magneto_kpi["ca_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(magneto_kpi["ca_reel"]-magneto_kpi["ca_objectif"]) }}</td>

                <td> {{ '{0:0.2f}'.format(magneto_kpi["ventes_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(magneto_kpi["vente_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(magneto_kpi["vente_reel"]-magneto_kpi["ventes_objectif"]) }}</td>

                <td> {{ '{0:0.2f}'.format(magneto_kpi["marge_objectif"]) }}</td>
                <td> {{ '{0:0.2f}'.format(magneto_kpi["marge_reel"]) }}</td>
                <td> {{ '{0:0.2f}'.format(magneto_kpi["marge_reel"]-magneto_kpi["marge_objectif"]) }}</td>
            </tr>

            <tr>
                <th bgcolor="#0FA">Total</th>

                {% set total_ca_objectif = hifi_kpi["ca_objectif"]+fours_kpi["ca_objectif"]+magneto_kpi["ca_objectif"] %}
                {% set total_ca_reel = hifi_kpi["ca_reel"]+fours_kpi["ca_reel"]+magneto_kpi["ca_reel"] %}
                <td> {{ '{0:0.2f}'.format(total_ca_objectif) }}</td>
                <td> {{ '{0:0.2f}'.format(total_ca_reel) }}</td>
                <td> {{ '{0:0.2f}'.format(total_ca_reel-total_ca_objectif) }}</td>

                {% set total_ventes_objectif = hifi_kpi["ventes_objectif"]+fours_kpi["ventes_objectif"]+magneto_kpi["ventes_objectif"] %}
                {% set total_ventes_reel = hifi_kpi["vente_reel"]+fours_kpi["vente_reel"]+magneto_kpi["vente_reel"] %}
                <td> {{ '{0:0.2f}'.format(total_ventes_objectif) }}</td>
                <td> {{ '{0:0.2f}'.format(total_ventes_reel) }}</td>
                <td> {{ '{0:0.2f}'.format(total_ventes_reel-total_ventes_objectif) }}</td>

                {% set total_marge_objectif = hifi_kpi["marge_objectif"]+fours_kpi["marge_objectif"]+magneto_kpi["marge_objectif"] %}
                {% set total_marge_reel = hifi_kpi["marge_reel"]+fours_kpi["marge_reel"]+magneto_kpi["marge_reel"] %}
                <td> {{ '{0:0.2f}'.format(total_marge_objectif) }}</td>
                <td> {{ '{0:0.2f}'.format(total_marge_reel) }}</td>
                <td> {{ '{0:0.2f}'.format(total_marge_reel-total_marge_objectif) }}</td>
            </tr>

            <tr>
                <th bgcolor="#0FA">Poids Hifi réel</th>

                <td  colspan="3"> {{ '{0:0.2f}'.format(hifi_kpi["ca_reel"] / total_ca_objectif * 100) }}%</td>
                <td  colspan="3"> {{ '{0:0.2f}'.format(hifi_kpi["vente_reel"] / total_ventes_objectif * 100) }}%</td>
                <td  colspan="3"> {{ '{0:0.2f}'.format(hifi_kpi["marge_reel"] / total_marge_reel * 100) }}%</td>
            </tr>

            <tr>
                <th bgcolor="#0FA">Poids Four réel</th>

                <td  colspan="3"> {{ '{0:0.2f}'.format(fours_kpi["ca_reel"] / total_ca_objectif * 100) }}%</td>
                <td  colspan="3"> {{ '{0:0.2f}'.format(fours_kpi["vente_reel"] / total_ventes_objectif * 100) }}%</td>
                <td  colspan="3"> {{ '{0:0.2f}'.format(fours_kpi["marge_reel"] / total_marge_reel * 100) }}%</td>
            </tr>

            <tr>
                <th bgcolor="#0FA">Poids Magnétoscope réel</th>

                <td  colspan="3"> {{ '{0:0.2f}'.format(magneto_kpi["ca_reel"] / total_ca_objectif * 100) }}%</td>
                <td  colspan="3"> {{ '{0:0.2f}'.format(magneto_kpi["vente_reel"] / total_ventes_objectif * 100) }}%</td>
                <td  colspan="3"> {{ '{0:0.2f}'.format(magneto_kpi["marge_reel"] / total_marge_reel * 100) }}%</td>
            </tr>

    </table>


    </div>
    

</div>
{% endblock %}


